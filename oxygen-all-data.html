<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>血氧详情</title>
    <style>
        :root {
            --bg-color: #16191d;
            --card-bg: #2c2f33;
            --text-primary: #ffffff;
            --text-secondary: #e5e5e5;
            --text-tertiary: #a0a0a0;
            --text-light: #888888;
            --accent-green: #4caf50;
            --accent-green-selected: #388e3c;
            --accent-blue: #2196f3;
            --accent-blue-selected: #1976d2;
            --link-blue: #8c9eff;
            --border-color: #3a3a3a;
            --range-low: #ff6b6b;
            --range-normal: #4caf50;
            --range-high: #ff9800;
            --event-irregular: #ff81c7;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 2rem 0;
        }
        .iphone-frame {
            width: 375px;
            height: 812px;
            background-color: #111;
            border-radius: 40px;
            padding: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 2px solid #444;
        }
        .screen {
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            border-radius: 32px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        /* Header Navigation */
        .header-nav {
            padding: 10px 15px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }
        .back-button {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--link-blue);
            text-decoration: none;
            font-size: 16px;
            padding: 5px;
        }
        .back-button svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .back-button:hover {
            opacity: 0.8;
        }
        .page-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .header-spacer {
            width: 60px;
        }
        
        .scroll-view {
            flex: 1;
            overflow-y: auto;
        }
        .scroll-view::-webkit-scrollbar { display: none; }
        .scroll-view { -ms-overflow-style: none; scrollbar-width: none; }

        /* Time Range Selector */
        .time-range-container {
            margin: 10px 15px;
            padding: 4px;
            background-color: #3a3a3a;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
        }
        .time-range-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            background-color: transparent;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .time-range-btn.active {
            background-color: var(--card-bg);
            color: var(--text-primary);
            font-weight: bold;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        /* RealTime Oxygen */
        .realtime-container {
            margin: 20px 15px;
            padding: 30px 20px;
            background-color: var(--card-bg);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* Circular Oxygen Display */
        .oxygen-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1976d2, #2196f3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
            animation: oxygenPulse 3s ease-in-out infinite;
        }
        
        @keyframes oxygenPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .oxygen-value { 
            font-size: 36px; 
            font-weight: bold; 
            color: white; 
            line-height: 1;
        }
        
        .oxygen-status {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 4px;
        }
        
        /* Range Bar */
        .range-bar-container { 
            width: 100%; 
            max-width: 320px;
        }
        
        .range-bar {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #ff6b6b 0%, #ff6b6b 33%, #4caf50 33%, #4caf50 100%);
            position: relative;
            margin: 15px 0;
        }
        
        .range-pointer {
            position: absolute;
            top: -8px;
            left: 80%; /* 98% oxygen position on the scale */
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 12px solid #333;
        }
        
        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .range-categories {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .range-categories span:nth-child(1) { color: #ff6b6b; }
        .range-categories span:nth-child(2) { color: #4caf50; }
        
        /* Chart */
        .chart-container {
            margin: 0 15px;
            padding: 10px 20px;
            background-color: var(--card-bg);
            border-radius: 10px;
            height: 250px;
            position: relative;
        }
        .chart-svg { width: 100%; height: 100%; }
        .grid-line { stroke: #3a3a3a; stroke-width: 0.5; }
        .axis-label { font-size: 12px; fill: var(--text-tertiary); }

        /* Summary Cards */
        .summary-container {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .summary-card {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .summary-card.active {
            background-color: var(--accent-green-selected);
        }
        .summary-card.active .summary-label,
        .summary-card.active .summary-value,
        .summary-card.active .summary-unit {
            color: white;
        }
        .summary-label { font-size: 16px; color: var(--text-primary); }
        .summary-value { font-size: 20px; font-weight: bold; color: var(--text-primary); }
        .summary-unit { font-size: 14px; color: var(--text-tertiary); margin-left: 4px; }
        
        /* Events Card */
        .events-card {
            margin: 10px 15px 20px;
            padding: 20px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
        }
        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .events-title-container { display: flex; align-items: center; gap: 8px; }
        .events-title { font-size: 20px; font-weight: bold; color: var(--text-secondary); }
        .event-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }
        .event-label-container { display: flex; align-items: center; gap: 10px; }
        .event-label { font-size: 18px; color: var(--text-secondary); }
        .event-count { font-size: 20px; font-weight: bold; color: var(--text-secondary); }
        .event-icon-small { width: 18px; height: 18px; }

        /* Learn More Link */
        .learn-more {
            text-align: center;
            padding: 30px 0;
            font-size: 16px;
            color: var(--link-blue);
            text-decoration: none;
            display: block;
        }
    </style>
</head>
<body>
    <div class="iphone-frame">
        <div class="screen">
            <div class="header-nav">
                <a href="breathing-all-data.html" class="back-button">
                    <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19L5 12 12 5"/></svg>
                    返回
                </a>
                <span class="page-title">血氧详情</span>
                <div class="header-spacer"></div>
            </div>
            <div class="scroll-view">
                <div class="time-range-container"></div>
                <div class="realtime-container">
                    <div class="oxygen-circle">
                        <div class="oxygen-value">98<span style="font-size: 20px;">%</span></div>
                        <div class="oxygen-status">正常范围</div>
                    </div>
                    <div class="range-bar-container">
                        <div class="range-labels">
                            <span>90</span>
                            <span>95</span>
                            <span>100</span>
                        </div>
                        <div class="range-bar">
                            <div class="range-pointer"></div>
                        </div>
                        <div class="range-categories">
                            <span>偏低</span>
                            <span>正常</span>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <svg class="chart-svg"></svg>
                </div>
                <div class="summary-container"></div>
                <div class="events-card">
                    <div class="events-header">
                        <div class="events-title-container">
                             <svg class="oxygen-icon" style="width:22px; height:22px; color: var(--accent-green);" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM12 8C8.13 8 5 11.13 5 15C5 18.87 8.13 22 12 22C15.87 22 19 18.87 19 15C19 11.13 15.87 8 12 8ZM12 20C9.24 20 7 17.76 7 15C7 12.24 9.24 10 12 10C14.76 10 17 12.24 17 15C17 17.76 14.76 20 12 20Z"/>
                             </svg>
                            <span class="events-title">血氧事件通知</span>
                        </div>
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--range-low);" viewBox="0 0 24 24">
                                <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM12 8C8.13 8 5 11.13 5 15C5 18.87 8.13 22 12 22C15.87 22 19 18.87 19 15C19 11.13 15.87 8 12 8ZM12 20C9.24 20 7 17.76 7 15C7 12.24 9.24 10 12 10C14.76 10 17 12.24 17 15C17 17.76 14.76 20 12 20Z"/>
                            </svg>
                            <span class="event-label">血氧偏低事件</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--range-high);" viewBox="0 0 24 24">
                                <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM12 8C8.13 8 5 11.13 5 15C5 18.87 8.13 22 12 22C15.87 22 19 18.87 19 15C19 11.13 15.87 8 12 8ZM12 20C9.24 20 7 17.76 7 15C7 12.24 9.24 10 12 10C14.76 10 17 12.24 17 15C17 17.76 14.76 20 12 20Z"/>
                            </svg>
                            <span class="event-label">血氧不稳定</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--event-irregular);" viewBox="0 0 24 24">
                                <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM12 8C8.13 8 5 11.13 5 15C5 18.87 8.13 22 12 22C15.87 22 19 18.87 19 15C19 11.13 15.87 8 12 8ZM12 20C9.24 20 7 17.76 7 15C7 12.24 9.24 10 12 10C14.76 10 17 12.24 17 15C17 17.76 14.76 20 12 20Z"/>
                            </svg>
                            <span class="event-label">睡眠血氧异常</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                </div>
                <a href="#" class="learn-more">了解更多关于血氧监测的信息</a>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const timeRanges = ['日', '周', '月', '年'];
    const timeRangeContainer = document.querySelector('.time-range-container');
    const svg = document.querySelector('.chart-svg');
    const summaryContainer = document.querySelector('.summary-container');
    const chartWidth = 350, chartHeight = 250;
    const chartPadding = { top: 20, bottom: 20, left: 20, right: 20 };
    const chartDrawableHeight = chartHeight - chartPadding.top - chartPadding.bottom;

    let activeTimeRange = '日';
    let selectedSummary = '';

    const summaryData = [
      { id: 'latest', label: '最新: 4:34', value: '98', unit: '%' },
      { id: 'range', label: '血氧范围', value: '95-100', unit: '%' },
      { id: 'average', label: '日均血氧', value: '97', unit: '%' },
      { id: 'sleep', label: '睡眠血氧', value: '96', unit: '%' },
    ];

    function getSleepOxygen(range) {
        if (range === '日') return '96';
        if (range === '周') return '95-97';
        if (range === '月') return '95-98';
        if (range === '年') return '94-98';
    }

    function updateOxygenDisplay(value, status) {
        const oxygenValueElement = document.querySelector('.oxygen-value');
        const oxygenStatusElement = document.querySelector('.oxygen-status');
        const rangePointerElement = document.querySelector('.range-pointer');
        const oxygenCircle = document.querySelector('.oxygen-circle');

        oxygenValueElement.innerHTML = `${value}<span style="font-size: 20px;">%</span>`;
        oxygenStatusElement.textContent = status;
        
        // Update pointer position and circle color based on value
        let pointerPosition = 80; // Default for 98%
        let circleColor = 'linear-gradient(135deg, #1976d2, #2196f3)'; // Default blue
        
        const numValue = parseInt(value);
        if (numValue < 95) {
            pointerPosition = 25;
            circleColor = 'linear-gradient(135deg, #d32f2f, #ff6b6b)'; // Red for low
        } else if (numValue >= 95 && numValue <= 100) {
            pointerPosition = 80;
            circleColor = 'linear-gradient(135deg, #1976d2, #2196f3)'; // Blue for normal
        }
        
        rangePointerElement.style.left = `${pointerPosition}%`;
        oxygenCircle.style.background = circleColor;
    }

    function hideRangeIndicator() {
        const rangeBarContainer = document.querySelector('.range-bar-container');
        if (rangeBarContainer) {
            rangeBarContainer.style.display = 'none';
        }
    }

    function showRangeIndicator() {
        const rangeBarContainer = document.querySelector('.range-bar-container');
        if (rangeBarContainer) {
            rangeBarContainer.style.display = 'block';
        }
    }

    function renderTimeRanges() {
        timeRangeContainer.innerHTML = '';
        timeRanges.forEach(range => {
            const btn = document.createElement('button');
            btn.className = `time-range-btn ${activeTimeRange === range ? 'active' : ''}`;
            btn.textContent = range;
            btn.onclick = () => {
                activeTimeRange = range;
                renderTimeRanges();
                renderChart();
                renderSummaryCards();
            };
            timeRangeContainer.appendChild(btn);
        });
    }

    function renderSummaryCards() {
        summaryContainer.innerHTML = '';
        const currentSummaryData = [...summaryData];
        currentSummaryData[3].value = getSleepOxygen(activeTimeRange);

        currentSummaryData.forEach(item => {
            const card = document.createElement('div');
            card.className = `summary-card ${selectedSummary === item.id ? 'active' : ''}`;
            card.innerHTML = `
                <span class="summary-label">${item.label}</span>
                <div>
                    <span class="summary-value">${item.value}</span>
                    <span class="summary-unit">${item.unit}</span>
                </div>
            `;
            card.onclick = () => {
                if (selectedSummary === item.id) {
                    selectedSummary = '';
                    updateOxygenDisplay('98', '正常范围');
                    showRangeIndicator();
                } else {
                    selectedSummary = item.id;
                    const displayValue = item.value.split('-')[0] || item.value;
                    let status = '正常范围';
                    
                    if (item.id === 'average') status = '日均血氧';
                    else if (item.id === 'sleep') status = '睡眠血氧';
                    else if (item.id === 'range') status = '血氧范围';
                    
                    updateOxygenDisplay(displayValue, status);
                    
                    if (item.id === 'average' || item.id === 'sleep') {
                        hideRangeIndicator();
                    } else {
                        showRangeIndicator();
                    }
                }
                renderSummaryCards();
                renderChart();
            };
            summaryContainer.appendChild(card);
        });
    }
    
    function generateChartData(range) {
        let points = [];
        let count = 0;
        let minBase, minVar, maxBase, maxVar;

        switch(range) {
            case '日': count = 60; minBase=96; minVar=2; maxBase=99; maxVar=1; break;
            case '周': count = 50; minBase=95; minVar=3; maxBase=100; maxVar=1; break;
            case '月': count = 70; minBase=95; minVar=3; maxBase=99; maxVar=2; break;
            case '年': count = 80; minBase=94; minVar=4; maxBase=100; maxVar=1; break;
        }
        
        // 生成血氧数据点，主要在95-100%范围内
        for (let i = 0; i < count; i++) {
            const min = (minBase - minVar) + Math.random() * (2 * minVar);
            const max = (maxBase - maxVar) + Math.random() * (2 * maxVar);
            points.push({
                x: Math.random(),
                y: Math.max(90, Math.min(100, min + Math.random() * (max - min)))
            });
        }
        
        // 少量异常血氧数据点
        const abnormalCount = Math.floor(count * 0.05);
        for (let i = 0; i < abnormalCount; i++) {
            points.push({
                x: Math.random(),
                y: 90 + Math.random() * 5
            });
        }
        
        return points;
    }

    function renderChart() {
        svg.innerHTML = '';
        const data = generateChartData(activeTimeRange);
        
        const yScale = (val) => chartHeight - chartPadding.bottom - ((val - 85) / 15) * chartDrawableHeight;
        
        // Grid lines and labels
        const yLabels = [85, 90, 95, 100];
        yLabels.forEach(val => {
            const y = yScale(val);
            svg.innerHTML += `<line class="grid-line" x1="${chartPadding.left}" y1="${y}" x2="${chartWidth - chartPadding.right}" y2="${y}"></line>`;
            svg.innerHTML += `<text class="axis-label" x="0" y="${y + 4}">${val}</text>`;
        });
        
        const xLabels = {
            '日': ['0时', '6时', '12时', '18时'],
            '周': ['一', '二', '三', '四', '五', '六', '日'],
            '月': ['1', '10', '20', '30'],
            '年': ['1月', '3月', '6月', '9月', '12月']
        }[activeTimeRange];
        
        xLabels.forEach((label, i) => {
            const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
            svg.innerHTML += `<text class="axis-label" x="${x}" y="${chartHeight}" text-anchor="middle">${label}</text>`;
        });

        // Scatter plot points
        const minData = Math.min(...data.map(d => d.y));
        const maxData = Math.max(...data.map(d => d.y));

        data.forEach(d => {
            const x = chartPadding.left + d.x * (chartWidth - chartPadding.left - chartPadding.right);
            const y = yScale(d.y);
            let color = 'var(--range-normal)'; // 默认绿色
            
            if (d.y < 95) {
                color = 'var(--range-low)'; // 红色 - 血氧偏低
            } else if (d.y >= 95 && d.y <= 100) {
                color = 'var(--range-normal)'; // 绿色 - 正常血氧
            }
            
            let opacity = 1;
            if (selectedSummary === 'range' && d.y !== minData && d.y !== maxData) {
                opacity = 0.3;
            }
            
            if (selectedSummary !== 'latest' && selectedSummary !== 'average' && selectedSummary !== 'sleep') {
                 svg.innerHTML += `<circle cx="${x}" cy="${y}" r="2.5" fill="${color}" opacity="${opacity}" />`;
            }
        });
        
        // Overlays for specific views
        if (selectedSummary === 'range') {
            const minPoint = data.reduce((prev, curr) => prev.y < curr.y ? prev : curr);
            const maxPoint = data.reduce((prev, curr) => prev.y > curr.y ? prev : curr);
            const minX = chartPadding.left + minPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const minY = yScale(minPoint.y);
            const maxX = chartPadding.left + maxPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const maxY = yScale(maxPoint.y);
            
            svg.innerHTML += `<circle cx="${minX}" cy="${minY}" r="4" fill="var(--accent-green)" />`;
            svg.innerHTML += `<text class="axis-label" x="${minX}" y="${minY - 10}" text-anchor="middle">最低 ${Math.round(minPoint.y)}</text>`;
            svg.innerHTML += `<circle cx="${maxX}" cy="${maxY}" r="4" fill="var(--accent-green)" />`;
            svg.innerHTML += `<text class="axis-label" x="${maxX}" y="${maxY - 10}" text-anchor="middle">最高 ${Math.round(maxPoint.y)}</text>`;
        }
        
        if (selectedSummary === 'latest') {
            const lastPoint = data[data.length - 1];
            const x = chartPadding.left + lastPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const y = yScale(lastPoint.y);
            svg.innerHTML += `<circle cx="${x}" cy="${y}" r="5" fill="var(--accent-green)" />`;
            svg.innerHTML += `<text class="axis-label" x="${x}" y="${y - 12}" text-anchor="middle">最新 ${Math.round(lastPoint.y)}</text>`;
        }
        
        // 平均血氧横线/趋势图
        if (selectedSummary === 'average') {
            const averageOxygen = 97;
            
            if (activeTimeRange === '日') {
                const lineY = yScale(averageOxygen);
                const lineStartX = chartPadding.left;
                const lineEndX = chartWidth - chartPadding.right;
                
                svg.innerHTML += `<line x1="${lineStartX}" y1="${lineY}" x2="${lineEndX}" y2="${lineY}" stroke="#4fc3f7" stroke-width="2" stroke-dasharray="5,3" />`;
                svg.innerHTML += `<text class="axis-label" x="${lineEndX - 10}" y="${lineY - 8}" text-anchor="end" fill="#4fc3f7">平均血氧 ${averageOxygen}</text>`;
            } else {
                const xLabels = {
                    '周': ['一', '二', '三', '四', '五', '六', '日'],
                    '月': ['1', '10', '20', '30'],
                    '年': ['1月', '3月', '6月', '9月', '12月']
                }[activeTimeRange];
                
                const trendPoints = [];
                xLabels.forEach((label, i) => {
                    const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
                    const variation = (Math.sin(i * 0.8) * 1.5) + (Math.random() - 0.5) * 1;
                    const y = yScale(averageOxygen + variation);
                    trendPoints.push({ x, y });
                });
                
                let pathD = `M${trendPoints[0].x},${trendPoints[0].y}`;
                for (let i = 1; i < trendPoints.length; i++) {
                    pathD += ` L${trendPoints[i].x},${trendPoints[i].y}`;
                }
                svg.innerHTML += `<path d="${pathD}" stroke="#4fc3f7" stroke-width="2" fill="none" />`;
                
                trendPoints.forEach(point => {
                    svg.innerHTML += `<circle cx="${point.x}" cy="${point.y}" r="3" fill="#4fc3f7" />`;
                });
                
                svg.innerHTML += `<text class="axis-label" x="${chartWidth - chartPadding.right - 10}" y="${chartPadding.top + 15}" text-anchor="end" fill="#4fc3f7">平均血氧趋势</text>`;
            }
        }
        
        // 睡眠血氧横线/趋势图
        if (selectedSummary === 'sleep') {
            const sleepOxygen = 96;
            
            if (activeTimeRange === '日') {
                const lineY = yScale(sleepOxygen);
                const lineStartX = chartPadding.left;
                const lineEndX = chartWidth - chartPadding.right;
                
                svg.innerHTML += `<line x1="${lineStartX}" y1="${lineY}" x2="${lineEndX}" y2="${lineY}" stroke="#81c784" stroke-width="2" stroke-dasharray="5,3" />`;
                svg.innerHTML += `<text class="axis-label" x="${lineEndX - 10}" y="${lineY - 8}" text-anchor="end" fill="#81c784">睡眠血氧 ${sleepOxygen}</text>`;
            } else {
                const xLabels = {
                    '周': ['一', '二', '三', '四', '五', '六', '日'],
                    '月': ['1', '10', '20', '30'],
                    '年': ['1月', '3月', '6月', '9月', '12月']
                }[activeTimeRange];
                
                const trendPoints = [];
                xLabels.forEach((label, i) => {
                    const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
                    const variation = (Math.sin(i * 0.6) * 1) + (Math.random() - 0.5) * 1;
                    const y = yScale(sleepOxygen + variation);
                    trendPoints.push({ x, y });
                });
                
                let pathD = `M${trendPoints[0].x},${trendPoints[0].y}`;
                for (let i = 1; i < trendPoints.length; i++) {
                    pathD += ` L${trendPoints[i].x},${trendPoints[i].y}`;
                }
                svg.innerHTML += `<path d="${pathD}" stroke="#81c784" stroke-width="2" fill="none" />`;
                
                trendPoints.forEach(point => {
                    svg.innerHTML += `<circle cx="${point.x}" cy="${point.y}" r="3" fill="#81c784" />`;
                });
                
                svg.innerHTML += `<text class="axis-label" x="${chartWidth - chartPadding.right - 10}" y="${chartPadding.top + 15}" text-anchor="end" fill="#81c784">睡眠血氧趋势</text>`;
            }
        }
    }

    renderTimeRanges();
    renderSummaryCards();
    renderChart();
});
</script>

</body>
</html> 