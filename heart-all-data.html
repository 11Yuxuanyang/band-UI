<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心率详情</title>
    <style>
        :root {
            --bg-color: #16191d; /* 更改为与主页一致的深色背景 */
            --card-bg: #2c2f33; /* 更改为与主页一致的卡片背景色 */
            --text-primary: #ffffff; /* 更改为白色文本 */
            --text-secondary: #e5e5e5;
            --text-tertiary: #a0a0a0;
            --text-light: #888888;
            --accent-red: #f44336;
            --accent-red-selected: #d9534f;
            --link-blue: #8c9eff;
            --border-color: #3a3a3a; /* 更深的边框颜色 */
            --range-slow: #87ceeb;
            --range-normal: #4caf50;
            --range-fast: #ff6b6b;
            --event-irregular: #ff81c7;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 2rem 0;
        }
        .iphone-frame {
            width: 375px;
            height: 812px;
            background-color: #111;
            border-radius: 40px;
            padding: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 2px solid #444;
        }
        .screen {
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            border-radius: 32px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        /* Header Navigation */
        .header-nav {
            padding: 10px 15px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }
        .back-button {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--link-blue);
            text-decoration: none;
            font-size: 16px;
            padding: 5px;
        }
        .back-button svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .back-button:hover {
            opacity: 0.8;
        }
        .page-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .header-spacer {
            width: 60px; /* 平衡左侧按钮的空间 */
        }
        
        .scroll-view {
            flex: 1;
            overflow-y: auto;
        }
        .scroll-view::-webkit-scrollbar { display: none; }
        .scroll-view { -ms-overflow-style: none; scrollbar-width: none; }

        /* Time Range Selector */
        .time-range-container {
            margin: 10px 15px;
            padding: 4px;
            background-color: #3a3a3a;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
        }
        .time-range-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            background-color: transparent;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .time-range-btn.active {
            background-color: var(--card-bg);
            color: var(--text-primary);
            font-weight: bold;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        /* RealTime Heart Rate */
        .realtime-container {
            margin: 20px 15px;
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .heart-icon {
            width: 40px;
            height: 40px;
            fill: var(--accent-red);
            animation: heartbeat 0.6s infinite alternate;
        }
        @keyframes heartbeat {
            from { transform: scale(1); }
            to { transform: scale(1.2); }
        }
        .heart-rate-value { font-size: 40px; font-weight: bold; color: var(--accent-red); }
        .heart-rate-label, .date-label { font-size: 14px; }
        .heart-rate-label { color: var(--text-secondary); }
        .date-label { color: var(--text-light); margin-top: 4px; }
        
        .range-bar-container { width: 160px; }
        .range-pointer {
            width: 20px;
            height: 15px;
            fill: var(--text-secondary);
            margin-bottom: -2px;
        }
        .range-bar {
            height: 12px;
            border-radius: 6px;
            display: flex;
            overflow: hidden;
        }
        .range-segment-slow { background-color: var(--range-slow); flex: 0.322; }
        .range-segment-normal { background-color: var(--range-normal); flex: 0.444; }
        .range-segment-fast { background-color: var(--range-fast); flex: 0.222; }
        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
            position: relative;
        }
        .range-labels span:nth-child(2) { position: absolute; left: 32.2%; transform: translateX(-50%);}
        .range-labels span:nth-child(3) { position: absolute; left: 76.6%; transform: translateX(-50%);}
        
        /* Status Indicator */
        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 60px;
        }
        .status-text {
            font-size: 18px;
            font-weight: 600;
            color: #4caf50;
            padding: 8px 16px;
            border-radius: 20px;
            background-color: rgba(76, 175, 80, 0.1);
        }
        
        /* Chart */
        .chart-container {
            margin: 0 15px;
            padding: 10px 20px;
            background-color: var(--card-bg);
            border-radius: 10px;
            height: 250px;
            position: relative;
        }
        .chart-svg { width: 100%; height: 100%; }
        .grid-line { stroke: #3a3a3a; stroke-width: 0.5; }
        .axis-label { font-size: 12px; fill: var(--text-tertiary); }

        /* Summary Cards */
        .summary-container {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .summary-card {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .summary-card.active {
            background-color: var(--accent-red-selected);
        }
        .summary-card.active .summary-label,
        .summary-card.active .summary-value,
        .summary-card.active .summary-unit {
            color: white;
        }
        .summary-label { font-size: 16px; color: var(--text-primary); }
        .summary-value { font-size: 20px; font-weight: bold; color: var(--text-primary); }
        .summary-unit { font-size: 14px; color: var(--text-tertiary); margin-left: 4px; }
        
        /* Events Card */
        .events-card {
            margin: 10px 15px 20px;
            padding: 20px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
        }
        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .events-title-container { display: flex; align-items: center; gap: 8px; }
        .events-title { font-size: 20px; font-weight: bold; color: var(--text-secondary); }
        .event-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }
        .event-label-container { display: flex; align-items: center; gap: 10px; }
        .event-label { font-size: 18px; color: var(--text-secondary); }
        .event-count { font-size: 20px; font-weight: bold; color: var(--text-secondary); }
        .event-icon-small { width: 18px; height: 18px; }

        /* Learn More Link */
        .learn-more {
            text-align: center;
            padding: 30px 0;
            font-size: 16px;
            color: var(--link-blue);
            text-decoration: none;
            display: block;
        }
    </style>
</head>
<body>
    <div class="iphone-frame">
        <div class="screen">
            <div class="header-nav">
                <a href="index.html" class="back-button">
                    <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19L5 12 12 5"/></svg>
                    返回
                </a>
                <span class="page-title">心率详情</span>
                <div class="header-spacer"></div>
            </div>
            <div class="scroll-view">
                <div class="time-range-container"></div>
                <div class="realtime-container">
                    <div class="heart-rate-info">
                        <svg class="heart-icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                        <div class="heart-rate-value">85</div>
                        <div class="heart-rate-label">实时心率 次/分</div>
                        <div class="date-label">今天</div>
                    </div>
                    <div class="range-bar-container">
                        <svg class="range-pointer" viewBox="0 0 20 15"><polygon points="10,0 20,15 0,15"/></svg>
                        <div class="range-bar">
                            <div class="range-segment-slow"></div>
                            <div class="range-segment-normal"></div>
                            <div class="range-segment-fast"></div>
                        </div>
                        <div class="range-labels">
                            <span>30</span><span>60</span><span>100</span>
                        </div>
                    </div>
                    <div class="status-indicator" style="display: none;">
                        <span class="status-text">正常</span>
                    </div>
                </div>
                <div class="chart-container">
                    <svg class="chart-svg"></svg>
                </div>
                <div class="summary-container"></div>
                <div class="events-card">
                    <div class="events-header">
                        <div class="events-title-container">
                             <svg class="heart-icon" style="width:22px; height:22px; animation:none;" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            <span class="events-title">心率事件通知</span>
                        </div>
                        <!-- BpmIcon placeholder -->
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--range-slow);" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            <span class="event-label">低事件</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--range-fast);" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            <span class="event-label">高事件</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                    <div class="event-item">
                        <div class="event-label-container">
                            <svg class="event-icon-small" style="fill: var(--event-irregular);" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            <span class="event-label">心律不齐</span>
                        </div>
                        <span class="event-count">0</span>
                    </div>
                </div>
                <a href="heart-explanation.html" class="learn-more">了解更多关于心率的信息</a>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const timeRanges = ['日', '周', '月', '年'];
    const timeRangeContainer = document.querySelector('.time-range-container');
    const svg = document.querySelector('.chart-svg');
    const summaryContainer = document.querySelector('.summary-container');
    const chartWidth = 350, chartHeight = 250;
    const chartPadding = { top: 20, bottom: 20, left: 20, right: 20 };
    const chartDrawableHeight = chartHeight - chartPadding.top - chartPadding.bottom;

    let activeTimeRange = '日';
    let selectedSummary = '';

    const summaryData = [
      { id: 'latest', label: '最新: 4:34', value: '85', unit: '次/分' },
      { id: 'range', label: '心率范围', value: '52-118', unit: '次/分' },
      { id: 'resting', label: '静息心率', value: '53', unit: '次/分' },
      { id: 'regular', label: '常规心率', value: '78', unit: '次/分' },
    ];

    function getRestingHeartRate(range) {
        if (range === '日') return '53';
        if (range === '周') return '48-55';
        if (range === '月') return '48-56';
        if (range === '年') return '48-65';
    }

    function updateHeartRateDisplay(value, label, date) {
        const heartRateValueElement = document.querySelector('.heart-rate-value');
        const heartRateLabelElement = document.querySelector('.heart-rate-label');
        const dateLabelElement = document.querySelector('.date-label');

        heartRateValueElement.textContent = value;
        heartRateLabelElement.textContent = label;
        dateLabelElement.textContent = date;
    }

    function hideRangeIndicator() {
        const rangeBarContainer = document.querySelector('.range-bar-container');
        const statusIndicator = document.querySelector('.status-indicator');
        if (rangeBarContainer) {
            rangeBarContainer.style.display = 'none';
        }
        if (statusIndicator) {
            statusIndicator.style.display = 'flex';
        }
    }

    function showRangeIndicator() {
        const rangeBarContainer = document.querySelector('.range-bar-container');
        const statusIndicator = document.querySelector('.status-indicator');
        if (rangeBarContainer) {
            rangeBarContainer.style.display = 'block';
        }
        if (statusIndicator) {
            statusIndicator.style.display = 'none';
        }
    }

    function renderTimeRanges() {
        timeRangeContainer.innerHTML = '';
        timeRanges.forEach(range => {
            const btn = document.createElement('button');
            btn.className = `time-range-btn ${activeTimeRange === range ? 'active' : ''}`;
            btn.textContent = range;
            btn.onclick = () => {
                activeTimeRange = range;
                renderTimeRanges();
                renderChart();
                renderSummaryCards();
            };
            timeRangeContainer.appendChild(btn);
        });
    }

    function renderSummaryCards() {
        summaryContainer.innerHTML = '';
        const currentSummaryData = [...summaryData];
        currentSummaryData[2].value = getRestingHeartRate(activeTimeRange);

        currentSummaryData.forEach(item => {
            const card = document.createElement('div');
            card.className = `summary-card ${selectedSummary === item.id ? 'active' : ''}`;
            card.innerHTML = `
                <span class="summary-label">${item.label}</span>
                <div>
                    <span class="summary-value">${item.value}</span>
                    <span class="summary-unit">${item.unit}</span>
                </div>
            `;
            card.onclick = () => {
                if (selectedSummary === item.id) {
                    selectedSummary = '';
                    // 恢复原始实时心率显示
                    updateHeartRateDisplay('85', '实时心率 次/分', '今天');
                    // 恢复显示心率范围指示器
                    showRangeIndicator();
                } else {
                    selectedSummary = item.id;
                    // 根据选择的项目更新显示
                    if (item.id === 'resting' || item.id === 'regular') {
                        updateHeartRateDisplay(item.value.split('-')[0] || item.value, item.label, '今天');
                        // 隐藏心率范围指示器
                        hideRangeIndicator();
                    } else {
                        // 显示心率范围指示器
                        showRangeIndicator();
                    }
                }
                renderSummaryCards();
                renderChart();
            };
            summaryContainer.appendChild(card);
        });
    }
    
    function generateChartData(range) {
        let points = [];
        let count = 0;
        let minBase, minVar, maxBase, maxVar;

        switch(range) {
            case '日': count = 60; minBase=55; minVar=10; maxBase=85; maxVar=15; break;
            case '周': count = 50; minBase=60; minVar=8; maxBase=90; maxVar=15; break;
            case '月': count = 70; minBase=60; minVar=12; maxBase=85; maxVar=15; break;
            case '年': count = 80; minBase=60; minVar=8; maxBase=90; maxVar=15; break;
        }
        
        // 生成基础数据点，主要在正常范围内
        for (let i = 0; i < count; i++) {
            const min = (minBase - minVar) + Math.random() * (2 * minVar);
            const max = (maxBase - maxVar) + Math.random() * (2 * maxVar);
            points.push({
                x: Math.random(),
                y: min + Math.random() * (max - min)
            });
        }
        
        // 大幅减少高心率范围的数据点（红色区域 > 100 bpm）
        const highHeartRateCount = Math.floor(count * 0.08); // 减少到8%的点为高心率
        for (let i = 0; i < highHeartRateCount; i++) {
            points.push({
                x: Math.random(),
                y: 100 + Math.random() * 25 // 100-125 bpm 的高心率范围，也减少了上限
            });
        }
        
        // 极少数的峰值点
        const peakCount = Math.floor(count * 0.02); // 减少到2%的点为峰值
        for (let i = 0; i < peakCount; i++) {
            points.push({
                x: Math.random(),
                y: 110 + Math.random() * 15 // 110-125 bpm 的峰值范围
            });
        }
        
        return points;
    }

    function renderChart() {
        svg.innerHTML = '';
        const data = generateChartData(activeTimeRange);
        
        const yScale = (val) => chartHeight - chartPadding.bottom - (val / 150) * chartDrawableHeight;
        
        // Grid lines and labels
        const yLabels = [0, 50, 100, 150];
        yLabels.forEach(val => {
            const y = yScale(val);
            svg.innerHTML += `<line class="grid-line" x1="${chartPadding.left}" y1="${y}" x2="${chartWidth - chartPadding.right}" y2="${y}"></line>`;
            svg.innerHTML += `<text class="axis-label" x="0" y="${y + 4}">${val}</text>`;
        });
        
        const xLabels = {
            '日': ['0时', '6时', '12时', '18时'],
            '周': ['一', '二', '三', '四', '五', '六', '日'],
            '月': ['1', '10', '20', '30'],
            '年': ['1月', '3月', '6月', '9月', '12月']
        }[activeTimeRange];
        
        xLabels.forEach((label, i) => {
            const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
            svg.innerHTML += `<text class="axis-label" x="${x}" y="${chartHeight}" text-anchor="middle">${label}</text>`;
        });

        // Scatter plot points
        const minData = Math.min(...data.map(d => d.y));
        const maxData = Math.max(...data.map(d => d.y));

        data.forEach(d => {
            const x = chartPadding.left + d.x * (chartWidth - chartPadding.left - chartPadding.right);
            const y = yScale(d.y);
            let color = 'var(--range-normal)'; // 默认绿色
            
            // 只使用标尺的三个颜色
            if (d.y < 60) {
                color = 'var(--range-slow)'; // 蓝色 - 低心率
            } else if (d.y >= 60 && d.y <= 100) {
                color = 'var(--range-normal)'; // 绿色 - 正常心率
            } else {
                color = 'var(--range-fast)'; // 红色 - 高心率
            }
            
            let opacity = 1;
            if (selectedSummary === 'range' && d.y !== minData && d.y !== maxData) {
                opacity = 0.3;
            }
            
            // 当选择静息心率或常规心率时，不显示散点图
            if (selectedSummary !== 'latest' && selectedSummary !== 'resting' && selectedSummary !== 'regular') {
                 svg.innerHTML += `<circle cx="${x}" cy="${y}" r="2.5" fill="${color}" opacity="${opacity}" />`;
            }
        });
        
        // Overlays for specific views
        if (selectedSummary === 'range') {
            const minPoint = data.reduce((prev, curr) => prev.y < curr.y ? prev : curr);
            const maxPoint = data.reduce((prev, curr) => prev.y > curr.y ? prev : curr);
            const minX = chartPadding.left + minPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const minY = yScale(minPoint.y);
            const maxX = chartPadding.left + maxPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const maxY = yScale(maxPoint.y);
            
            svg.innerHTML += `<circle cx="${minX}" cy="${minY}" r="4" fill="var(--accent-red)" />`;
            svg.innerHTML += `<text class="axis-label" x="${minX}" y="${minY - 10}" text-anchor="middle">最低 ${Math.round(minPoint.y)}</text>`;
            svg.innerHTML += `<circle cx="${maxX}" cy="${maxY}" r="4" fill="var(--accent-red)" />`;
            svg.innerHTML += `<text class="axis-label" x="${maxX}" y="${maxY - 10}" text-anchor="middle">最高 ${Math.round(maxPoint.y)}</text>`;
        }
        
        if (selectedSummary === 'latest') {
            const lastPoint = data[data.length - 1];
            const x = chartPadding.left + lastPoint.x * (chartWidth - chartPadding.left - chartPadding.right);
            const y = yScale(lastPoint.y);
            svg.innerHTML += `<circle cx="${x}" cy="${y}" r="5" fill="var(--accent-red)" />`;
            svg.innerHTML += `<text class="axis-label" x="${x}" y="${y - 12}" text-anchor="middle">最新 ${Math.round(lastPoint.y)}</text>`;
        }
        
        // 静息心率横线/趋势图
        if (selectedSummary === 'resting') {
            const restingRate = 60; // 静息心率基准值
            
            if (activeTimeRange === '日') {
                // 日视图：显示水平线
                const lineY = yScale(restingRate);
                const lineStartX = chartPadding.left;
                const lineEndX = chartWidth - chartPadding.right;
                
                svg.innerHTML += `<line x1="${lineStartX}" y1="${lineY}" x2="${lineEndX}" y2="${lineY}" stroke="#4fc3f7" stroke-width="2" stroke-dasharray="5,3" />`;
                svg.innerHTML += `<text class="axis-label" x="${lineEndX - 10}" y="${lineY - 8}" text-anchor="end" fill="#4fc3f7">静息心率 ${restingRate}</text>`;
            } else {
                // 周、月、年：显示趋势图
                const xLabels = {
                    '周': ['一', '二', '三', '四', '五', '六', '日'],
                    '月': ['1', '10', '20', '30'],
                    '年': ['1月', '3月', '6月', '9月', '12月']
                }[activeTimeRange];
                
                const trendPoints = [];
                xLabels.forEach((label, i) => {
                    const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
                    // 添加一些变化，模拟真实趋势
                    const variation = (Math.sin(i * 0.8) * 3) + (Math.random() - 0.5) * 2;
                    const y = yScale(restingRate + variation);
                    trendPoints.push({ x, y });
                });
                
                // 绘制趋势线
                let pathD = `M${trendPoints[0].x},${trendPoints[0].y}`;
                for (let i = 1; i < trendPoints.length; i++) {
                    pathD += ` L${trendPoints[i].x},${trendPoints[i].y}`;
                }
                svg.innerHTML += `<path d="${pathD}" stroke="#4fc3f7" stroke-width="2" fill="none" />`;
                
                // 绘制数据点
                trendPoints.forEach(point => {
                    svg.innerHTML += `<circle cx="${point.x}" cy="${point.y}" r="3" fill="#4fc3f7" />`;
                });
                
                // 添加标签
                svg.innerHTML += `<text class="axis-label" x="${chartWidth - chartPadding.right - 10}" y="${chartPadding.top + 15}" text-anchor="end" fill="#4fc3f7">静息心率趋势</text>`;
            }
        }
        
        // 常规心率横线/趋势图
        if (selectedSummary === 'regular') {
            const regularRate = 78; // 常规心率基准值
            
            if (activeTimeRange === '日') {
                // 日视图：显示水平线
                const lineY = yScale(regularRate);
                const lineStartX = chartPadding.left;
                const lineEndX = chartWidth - chartPadding.right;
                
                svg.innerHTML += `<line x1="${lineStartX}" y1="${lineY}" x2="${lineEndX}" y2="${lineY}" stroke="#81c784" stroke-width="2" stroke-dasharray="5,3" />`;
                svg.innerHTML += `<text class="axis-label" x="${lineEndX - 10}" y="${lineY - 8}" text-anchor="end" fill="#81c784">常规心率 ${regularRate}</text>`;
            } else {
                // 周、月、年：显示趋势图
                const xLabels = {
                    '周': ['一', '二', '三', '四', '五', '六', '日'],
                    '月': ['1', '10', '20', '30'],
                    '年': ['1月', '3月', '6月', '9月', '12月']
                }[activeTimeRange];
                
                const trendPoints = [];
                xLabels.forEach((label, i) => {
                    const x = chartPadding.left + i * ((chartWidth - chartPadding.left - chartPadding.right) / (xLabels.length - 1));
                    // 添加一些变化，模拟真实趋势
                    const variation = (Math.sin(i * 0.6) * 4) + (Math.random() - 0.5) * 3;
                    const y = yScale(regularRate + variation);
                    trendPoints.push({ x, y });
                });
                
                // 绘制趋势线
                let pathD = `M${trendPoints[0].x},${trendPoints[0].y}`;
                for (let i = 1; i < trendPoints.length; i++) {
                    pathD += ` L${trendPoints[i].x},${trendPoints[i].y}`;
                }
                svg.innerHTML += `<path d="${pathD}" stroke="#81c784" stroke-width="2" fill="none" />`;
                
                // 绘制数据点
                trendPoints.forEach(point => {
                    svg.innerHTML += `<circle cx="${point.x}" cy="${point.y}" r="3" fill="#81c784" />`;
                });
                
                // 添加标签
                svg.innerHTML += `<text class="axis-label" x="${chartWidth - chartPadding.right - 10}" y="${chartPadding.top + 15}" text-anchor="end" fill="#81c784">常规心率趋势</text>`;
            }
        }
    }

    renderTimeRanges();
    renderSummaryCards();
    renderChart();
});
</script>

</body>
</html>
